<div class="announcements-container">
  <div class="page-header page-header--row">
    <h2 class="page-header__title">Announcements</h2>
    <%= link_to "Create New", new_announcement_path, class: "btn btn-primary" %>
  </div>

  <!-- Filter Tabs -->
  <div class="filter-tabs">
    <%= link_to announcements_path, class: "filter-tab #{@current_status.nil? ? 'active' : ''}" do %>
      All <span class="filter-tab__count"><%= @status_counts[:all] %></span>
    <% end %>
    <%= link_to announcements_path(status: "draft"), class: "filter-tab #{@current_status == 'draft' ? 'active' : ''}" do %>
      Drafts <span class="filter-tab__count"><%= @status_counts[:draft] %></span>
    <% end %>
    <%= link_to announcements_path(status: "scheduled"), class: "filter-tab #{@current_status == 'scheduled' ? 'active' : ''}" do %>
      Scheduled <span class="filter-tab__count"><%= @status_counts[:scheduled] %></span>
    <% end %>
    <%= link_to announcements_path(status: "sent"), class: "filter-tab #{@current_status == 'sent' ? 'active' : ''}" do %>
      Sent <span class="filter-tab__count"><%= @status_counts[:sent] %></span>
    <% end %>
    <%= link_to announcements_path(status: "failed"), class: "filter-tab #{@current_status == 'failed' ? 'active' : ''}" do %>
      Failed <span class="filter-tab__count"><%= @status_counts[:failed] %></span>
    <% end %>
  </div>

  <% if @announcements.any? %>
    <div class="announcements-grid">
      <% @announcements.each do |announcement| %>
        <div class="announcement-card">
          <div class="announcement-content">
            <div class="announcement-header">
              <h2 class="announcement-title"><%= announcement.title %></h2>
              <span class="status-badge status-<%= announcement.status %>">
                <%= announcement.status %>
              </span>
            </div>

            <div class="announcement-body">
              <%= truncate(announcement.base_body, length: 200) %>
            </div>

            <div class="announcement-meta">
              <div class="meta-item">
                <span><%= announcement.created_at.strftime("%b %d, %Y at %I:%M %p") %></span>
              </div>

              <% if announcement.scheduled_for.present? %>
                <div class="meta-item">
                  <span>Scheduled for <%= announcement.scheduled_for.strftime("%b %d, %Y at %I:%M %p") %></span>
                </div>
              <% end %>

              <div class="meta-item">
                <span>Channels:</span>
                <div class="channels">
                  <% if announcement.send_to_slack %>
                    <span class="channel-badge">Slack</span>
                  <% end %>
                  <% if announcement.send_to_email %>
                    <span class="channel-badge">Email</span>
                  <% end %>
                  <% if announcement.send_to_whatsapp %>
                    <span class="channel-badge">WhatsApp</span>
                  <% end %>
                </div>
              </div>

              <div class="meta-item">
                <span><%= announcement.audiences.count %> <%= 'audience'.pluralize(announcement.audiences.count) %></span>
              </div>
            </div>

            <div class="announcement-actions">
              <%= link_to "View Details", announcement_path(announcement), class: "btn btn--sm btn-primary" %>
              <% if announcement.status.in?(%w[draft failed]) %>
                <%= link_to "Edit", edit_announcement_path(announcement), class: "btn btn--sm btn-secondary" %>
              <% end %>
            </div>
          </div>
        </div>
      <% end %>
    </div>
  <% else %>
    <div class="empty-state">
      <div class="empty-state__icon">ðŸ“¢</div>
      <% if @current_status.present? %>
        <h3>No <%= @current_status %> announcements</h3>
        <p>There are no announcements with "<%= @current_status %>" status</p>
        <div class="empty-state__actions">
          <%= link_to "View All Announcements", announcements_path, class: "btn btn-secondary" %>
          <%= link_to "Create Announcement", new_announcement_path, class: "btn btn-primary" %>
        </div>
      <% else %>
        <h3>No announcements yet</h3>
        <p>Create your first announcement to get started</p>
        <div class="empty-state__actions">
          <%= link_to "Create Announcement", new_announcement_path, class: "btn btn-primary" %>
        </div>
      <% end %>
    </div>
  <% end %>
</div>
